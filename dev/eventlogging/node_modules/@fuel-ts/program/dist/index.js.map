{"version":3,"sources":["../src/index.ts","../src/constants.ts","../src/utils.ts","../src/errors.ts","../src/functions/invocation-scope.ts","../src/functions/base-invocation-scope.ts","../src/contract-call-script.ts","../src/multicall/static-out/multicall-bin.ts","../src/script-request.ts","../src/functions/invocation-results.ts","../src/functions/multicall-scope.ts","../src/contract.ts"],"sourcesContent":["export * from './types';\nexport * from './utils';\nexport * from './errors';\nexport { FunctionInvocationScope } from './functions/invocation-scope';\nexport { MultiCallInvocationScope } from './functions/multicall-scope';\nexport { InvocationResult, FunctionInvocationResult } from './functions/invocation-results';\nexport { default as Contract } from './contract';\nexport { ScriptRequest } from './script-request';\n","// From https://github.com/FuelLabs/fuel-asm/blob/eb78378c3b7c22a53b834381c387d89b3c0ef122/src/panic_reason.rs#L13\nexport const PANIC_REASONS = [\n  'Success',\n  'Revert',\n  'OutOfGas',\n  'TransactionValidity',\n  'MemoryOverflow',\n  'ArithmeticOverflow',\n  'ContractNotFound',\n  'MemoryOwnership',\n  'NotEnoughBalance',\n  'ExpectedInternalContext',\n  'AssetIdNotFound',\n  'InputNotFound',\n  'OutputNotFound',\n  'WitnessNotFound',\n  'TransactionMaturity',\n  'InvalidMetadataIdentifier',\n  'MalformedCallStructure',\n  'ReservedRegisterNotWritable',\n  'ErrorFlag',\n  'InvalidImmediateValue',\n  'ExpectedCoinInput',\n  'MaxMemoryAccess',\n  'MemoryWriteOverlap',\n  'ContractNotInInputs',\n  'InternalBalanceOverflow',\n  'ContractMaxSize',\n  'ExpectedUnallocatedStack',\n  'MaxStaticContractsReached',\n  'TransferAmountCannotBeZero',\n  'ExpectedOutputVariable',\n  'ExpectedParentInternalContext',\n  'IllegalJump',\n  'NonZeroMessageOutputRecipient',\n  'ZeroedMessageOutputRecipient',\n];\n\nexport const PANIC_DOC_URL = 'https://docs.rs/fuel-asm/latest/fuel_asm/enum.PanicReason.html';\n","import type { TransactionResult } from '@fuel-ts/providers';\n\nimport { PANIC_DOC_URL, PANIC_REASONS } from './constants';\n\nconst getFailureReason = (reason: string): string =>\n  PANIC_REASONS.includes(reason) ? reason : 'unknown';\n\nexport const getDocs = (\n  status: TransactionResult<'failure'>['status']\n): { doc: string; reason: string } => {\n  if (status?.type === 'failure') {\n    const reason = getFailureReason(status.reason);\n    return {\n      doc: reason !== 'unknown' ? `${PANIC_DOC_URL}#variant.${reason}` : PANIC_DOC_URL,\n      reason,\n    };\n  }\n  return { doc: PANIC_DOC_URL, reason: 'unknown' };\n};\n\n/**\n * Generic assert function to avoid undesirable errors\n */\nexport function assert(condition: unknown, message: string): asserts condition {\n  if (!condition) {\n    throw new Error(message);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ZeroBytes32 } from '@fuel-ts/constants';\nimport type { TransactionResult, TransactionResultRevertReceipt } from '@fuel-ts/providers';\nimport { ReceiptType } from '@fuel-ts/transactions';\n\nimport { getDocs } from './utils';\n\nconst bigintReplacer = (key: unknown, value: unknown) =>\n  typeof value === 'bigint' ? value.toString() : value;\n\nconst printLineWithId = (id: string, line: string) =>\n  `${id === ZeroBytes32 ? 'script' : id}: ${line}`;\n\nexport class ScriptResultDecoderError extends Error {\n  logs: any[];\n  constructor(result: TransactionResult<'failure'>, message: string, logs: Array<any>) {\n    const docLink = JSON.stringify(getDocs(result.status), null, 2);\n    const revertReceipts = result.receipts.filter(\n      (r) => r.type === ReceiptType.Revert\n    ) as TransactionResultRevertReceipt[];\n    const revertsText = revertReceipts.length\n      ? `Reverts:\\n${revertReceipts\n          .map(({ id, ...r }) =>\n            printLineWithId(id, `${r.val} ${JSON.stringify(r, bigintReplacer)}`)\n          )\n          .join('\\n')}`\n      : null;\n    const logsText = logs.length ? `Logs:\\n${JSON.stringify(logs, null, 2)}` : null;\n    const receiptsText = `Receipts:\\n${JSON.stringify(\n      result.receipts.map(({ type, ...r }) => ({ type: ReceiptType[type], ...r })),\n      bigintReplacer,\n      2\n    )}`;\n    super(\n      `${message}\\n\\n${docLink}\\n\\n${revertsText ? `${revertsText}\\n\\n` : ''}${\n        logsText ? `${logsText}\\n\\n` : ''\n      }${receiptsText}`\n    );\n    this.logs = logs;\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport type { FunctionFragment } from '@fuel-ts/abi-coder';\nimport type { AbstractProgram } from '@fuel-ts/interfaces';\nimport type { CoinQuantity } from '@fuel-ts/providers';\nimport { coinQuantityfy } from '@fuel-ts/providers';\n\nimport type { CallConfig, CallParams } from '../types';\n\nimport { BaseInvocationScope } from './base-invocation-scope';\n\nexport class FunctionInvocationScope<\n  TArgs extends Array<any> = Array<any>,\n  TReturn = any\n> extends BaseInvocationScope<TReturn> {\n  protected func: FunctionFragment;\n  private callParameters?: CallParams;\n  private forward?: CoinQuantity;\n  protected args: TArgs;\n\n  constructor(program: AbstractProgram, func: FunctionFragment, args: TArgs) {\n    super(program, false);\n    this.func = func;\n    this.args = args || [];\n    this.setArguments(...args);\n    super.addCall(this);\n  }\n\n  getCallConfig(): CallConfig<TArgs> {\n    return {\n      func: this.func,\n      program: this.program,\n      callParameters: this.callParameters,\n      txParameters: this.txParameters,\n      forward: this.forward,\n      args: this.args,\n      bytesOffset: this.transactionRequest.bytesOffset || 0,\n    };\n  }\n\n  setArguments(...args: TArgs) {\n    this.args = args || [];\n    this.updateScriptRequest();\n    return this;\n  }\n\n  callParams(callParams: CallParams) {\n    this.callParameters = callParams;\n\n    if (callParams?.forward) {\n      this.forward = coinQuantityfy(callParams.forward);\n    }\n\n    // Update transaction script with new forward params\n    this.setArguments(...this.args);\n\n    // Update required coins\n    this.updateRequiredCoins();\n\n    return this;\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport type { InputValue } from '@fuel-ts/abi-coder';\nimport type { AbstractContract, AbstractProgram } from '@fuel-ts/interfaces';\nimport { bn, toNumber } from '@fuel-ts/math';\nimport type { Provider, CoinQuantity, TransactionRequest } from '@fuel-ts/providers';\nimport { transactionRequestify, ScriptTransactionRequest } from '@fuel-ts/providers';\nimport { MAX_GAS_PER_TX, InputType } from '@fuel-ts/transactions';\n\nimport { contractCallScript } from '../contract-call-script';\nimport type {\n  CallOptions,\n  ContractCall,\n  InvocationScopeLike,\n  TransactionCostOptions,\n  TxParams,\n} from '../types';\nimport { assert } from '../utils';\n\nimport { InvocationCallResult, FunctionInvocationResult } from './invocation-results';\n\nfunction createContractCall(funcScope: InvocationScopeLike): ContractCall {\n  const { program, args, forward, func, callParameters, bytesOffset } = funcScope.getCallConfig();\n\n  const data = program.interface.encodeFunctionData(\n    func,\n    args as Array<InputValue>,\n    contractCallScript.getScriptDataOffset() + bytesOffset\n  );\n\n  return {\n    contractId: (program as AbstractContract).id,\n    data,\n    assetId: forward?.assetId,\n    amount: forward?.amount,\n    gas: callParameters?.gasLimit,\n  };\n}\n\nexport class BaseInvocationScope<TReturn = any> {\n  transactionRequest: ScriptTransactionRequest;\n  protected program: AbstractProgram;\n  protected functionInvocationScopes: Array<InvocationScopeLike> = [];\n  protected txParameters?: TxParams;\n  protected requiredCoins: CoinQuantity[] = [];\n  protected isMultiCall: boolean = false;\n\n  constructor(program: AbstractProgram, isMultiCall: boolean) {\n    this.program = program;\n    this.isMultiCall = isMultiCall;\n    this.transactionRequest = new ScriptTransactionRequest({\n      gasLimit: MAX_GAS_PER_TX,\n    });\n  }\n\n  protected get calls() {\n    return this.functionInvocationScopes.map((funcScope) => createContractCall(funcScope));\n  }\n\n  protected static getCallOptions(options?: CallOptions) {\n    return { fundTransaction: true, ...options };\n  }\n\n  protected updateScriptRequest() {\n    const calls = this.calls;\n    calls.forEach((c) => {\n      this.transactionRequest.addContract(c.contractId);\n    });\n    this.transactionRequest.setScript(contractCallScript, calls);\n  }\n\n  protected getRequiredCoins(): Array<CoinQuantity> {\n    const assets = this.calls\n      .map((call) => ({\n        assetId: String(call.assetId),\n        amount: bn(call.amount || 0),\n      }))\n      .concat(this.transactionRequest.calculateFee())\n      .filter(({ assetId, amount }) => assetId && !bn(amount).isZero());\n    return assets;\n  }\n\n  protected updateRequiredCoins() {\n    const assets = this.getRequiredCoins();\n    const reduceForwardCoins = (\n      requiredCoins: Map<any, CoinQuantity>,\n      { assetId, amount }: CoinQuantity\n    ) => {\n      const currentAmount = requiredCoins.get(assetId)?.amount || bn(0);\n\n      return requiredCoins.set(assetId, {\n        assetId: String(assetId),\n        amount: currentAmount.add(amount),\n      });\n    };\n    this.requiredCoins = Array.from(\n      assets.reduce(reduceForwardCoins, new Map<any, CoinQuantity>()).values()\n    );\n  }\n\n  protected addCall(funcScope: InvocationScopeLike) {\n    this.addCalls([funcScope]);\n    return this;\n  }\n\n  protected addCalls(funcScopes: Array<InvocationScopeLike>) {\n    this.functionInvocationScopes.push(...funcScopes);\n    this.updateScriptRequest();\n    this.updateRequiredCoins();\n    return this;\n  }\n\n  protected async prepareTransaction(options?: CallOptions) {\n    // Update request scripts before call\n    this.updateScriptRequest();\n\n    // Update required coins before call\n    this.updateRequiredCoins();\n\n    // Check if gasLimit is less than the\n    // sum of all call gasLimits\n    this.checkGasLimitTotal();\n\n    // Add funds required on forwards and to pay gas\n    const opts = BaseInvocationScope.getCallOptions(options);\n    if (opts.fundTransaction && this.program.account) {\n      await this.fundWithRequiredCoins();\n    }\n  }\n\n  protected checkGasLimitTotal() {\n    const gasLimitOnCalls = this.calls.reduce((total, call) => total.add(call.gas || 0), bn(0));\n    if (gasLimitOnCalls.gt(this.transactionRequest.gasLimit)) {\n      throw new Error(\n        \"Transaction gasLimit can't be lower than the sum of the forwarded gas of each call\"\n      );\n    }\n  }\n\n  /**\n   * Run a valid transaction in dryRun mode and returns useful details about\n   * gasUsed, gasPrice and transaction estimate fee in native coins.\n   */\n  async getTransactionCost(options?: TransactionCostOptions) {\n    const provider = (this.program.account?.provider || this.program.provider) as Provider;\n    assert(provider, 'Wallet or Provider is required!');\n\n    await this.prepareTransaction(options);\n    const request = transactionRequestify(this.transactionRequest);\n    request.gasPrice = bn(toNumber(request.gasPrice) || toNumber(options?.gasPrice || 0));\n    const txCost = await provider.getTransactionCost(request, options?.tolerance);\n\n    return txCost;\n  }\n\n  /**\n   * Add to the transaction scope the required amount of unspent UTXO's.\n   *\n   * Required Amount = forward coins + transfers + gas fee.\n   */\n  async fundWithRequiredCoins() {\n    // Clean coin inputs before add new coins to the request\n    this.transactionRequest.inputs = this.transactionRequest.inputs.filter(\n      (i) => i.type !== InputType.Coin\n    );\n    const resources = await this.program.account?.getResourcesToSpend(this.requiredCoins);\n    this.transactionRequest.addResources(resources || []);\n    return this;\n  }\n\n  txParams(txParams: TxParams) {\n    this.txParameters = txParams;\n    const request = this.transactionRequest;\n\n    request.gasLimit = bn(txParams.gasLimit || request.gasLimit);\n    request.gasPrice = bn(txParams.gasPrice || request.gasPrice);\n    request.addVariableOutputs(this.txParameters?.variableOutputs || 0);\n\n    return this;\n  }\n\n  addContracts(contracts: Array<AbstractContract>) {\n    contracts.forEach((contract) => {\n      this.transactionRequest.addContract(contract.id);\n      this.program.interface.updateExternalLoggedTypes(contract.id.toB256(), [\n        ...contract.interface.loggedTypes,\n      ]);\n    });\n    return this;\n  }\n\n  /**\n   * Prepare transaction request object, adding Inputs, Outputs, coins, check gas costs\n   * and transaction validity.\n   *\n   * It's possible to get the transaction without adding coins, by passing `fundTransaction`\n   * as false.\n   */\n  async getTransactionRequest(options?: CallOptions): Promise<TransactionRequest> {\n    await this.prepareTransaction(options);\n    return this.transactionRequest;\n  }\n\n  /**\n   * Submits a transaction to the blockchain.\n   *\n   * This is a final action and will spend the coins and change the state of the contract.\n   * It also means that invalid transactions will throw an error, and consume gas. To avoid this\n   * running invalid tx and consuming gas try to `simulate` first when possible.\n   */\n  async call<T = TReturn>(options?: CallOptions): Promise<FunctionInvocationResult<T>> {\n    assert(this.program.account, 'Wallet is required!');\n\n    const transactionRequest = await this.getTransactionRequest(options);\n    const response = await this.program.account.sendTransaction(transactionRequest);\n\n    return FunctionInvocationResult.build<T>(\n      this.functionInvocationScopes,\n      response,\n      this.isMultiCall,\n      this.program as AbstractContract\n    );\n  }\n\n  /**\n   * Run a valid transaction and return the result without change the chain state.\n   * This means, all signatures are validated but no UTXO is spent.\n   *\n   * This method is useful for validate propose to avoid spending coins on invalid TXs, also\n   * to estimate the amount of gas that will be required to run the transaction.\n   */\n  async simulate<T = TReturn>(options?: CallOptions): Promise<InvocationCallResult<T>> {\n    assert(this.program.account, 'Wallet is required!');\n\n    const transactionRequest = await this.getTransactionRequest(options);\n    const result = await this.program.account.simulateTransaction(transactionRequest);\n\n    return InvocationCallResult.build<T>(this.functionInvocationScopes, result, this.isMultiCall);\n  }\n\n  /**\n   * Executes a transaction in dry run mode, without UTXO validations.\n   *\n   * A transaction in dry run mode can't change the state of the blockchain. It can be useful to access readonly\n   * methods or just ust get.\n   * The UTXO validation disable in this case, enables to send invalid inputs to emulate different conditions, of a\n   * transaction\n   */\n  async dryRun<T = TReturn>(options?: CallOptions): Promise<InvocationCallResult<T>> {\n    const provider = (this.program.account?.provider || this.program.provider) as Provider;\n    assert(provider, 'Wallet or Provider is required!');\n\n    const transactionRequest = await this.getTransactionRequest(options);\n    const request = transactionRequestify(transactionRequest);\n    const response = await provider.call(request, {\n      utxoValidation: false,\n    });\n    const result = await InvocationCallResult.build<T>(\n      this.functionInvocationScopes,\n      response,\n      this.isMultiCall\n    );\n\n    return result;\n  }\n\n  /**\n   * Executes a readonly contract method call.\n   *\n   * Under the hood it uses the `dryRun` method but don't fund the transaction\n   * with coins by default, for emulating executions with forward coins use `dryRun`\n   * or pass the options.fundTransaction as true\n   */\n  async get<T = TReturn>(options?: CallOptions): Promise<InvocationCallResult<T>> {\n    return this.dryRun<T>({\n      fundTransaction: false,\n      ...options,\n    });\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { arrayify, concat } from '@ethersproject/bytes';\nimport type { ArrayCoder, StructCoder } from '@fuel-ts/abi-coder';\nimport { AbiCoder, U64Coder } from '@fuel-ts/abi-coder';\nimport { bn, toNumber } from '@fuel-ts/math';\nimport { ReceiptType } from '@fuel-ts/transactions';\n\nimport contractCallScriptAbi from './multicall/static-out/multicall-abi.json';\nimport contractCallScriptBin from './multicall/static-out/multicall-bin';\nimport { ScriptRequest } from './script-request';\nimport type { ContractCall } from './types';\n\n/**\n * A script that calls contracts\n *\n * Accepts a contract ID and function data\n * Returns function result\n */\nexport const contractCallScript = new ScriptRequest<ContractCall[], Uint8Array[]>(\n  // Script to call the contract\n  contractCallScriptBin,\n  (contractCalls) => {\n    const inputs = contractCallScriptAbi[0].inputs;\n    const scriptDataCoder = new AbiCoder().getCoder(inputs[0]) as StructCoder<any>;\n    const callSlotsLength = (scriptDataCoder.coders.calls as ArrayCoder<any>).length;\n\n    if (contractCalls.length > callSlotsLength) {\n      throw new Error(`At most ${callSlotsLength} calls are supported`);\n    }\n\n    let refArgData = new Uint8Array();\n\n    const scriptCallSlots = [];\n    for (let i = 0; i < callSlotsLength; i += 1) {\n      const call = contractCalls[i];\n\n      let scriptCallSlot;\n      if (call) {\n        // Decode data in internal format\n        const dataArray = arrayify(call.data);\n        const functionSelector = dataArray.slice(0, 8);\n        const isReferenceType = dataArray.slice(8, 16).some((b) => b === 0x01);\n        const args = dataArray.slice(16);\n\n        let fnArg;\n        if (isReferenceType) {\n          fnArg = { Data: [refArgData.length, args.length] };\n          refArgData = concat([refArgData, args]);\n        } else {\n          fnArg = { Value: new U64Coder().decode(args, 0)[0] };\n        }\n\n        const scriptCall = {\n          contract_id: { value: call.contractId },\n          fn_selector: new U64Coder().decode(functionSelector, 0)[0],\n          fn_arg: fnArg,\n          parameters: {\n            amount: call.amount ? bn(call.amount) : undefined,\n            asset_id: call.assetId ? { value: call.assetId } : undefined,\n            gas: call.gas ? bn(call.gas) : undefined,\n          },\n        };\n\n        scriptCallSlot = scriptCall;\n      } else {\n        scriptCallSlot = undefined;\n      }\n\n      scriptCallSlots.push(scriptCallSlot);\n    }\n\n    const scriptData = {\n      calls: scriptCallSlots,\n    };\n\n    const encodedScriptData = scriptDataCoder.encode(scriptData as any);\n    return concat([encodedScriptData, refArgData]);\n  },\n  (result) => {\n    if (toNumber(result.code) !== 0) {\n      throw new Error(`Script returned non-zero result: ${result.code}`);\n    }\n    if (result.returnReceipt.type !== ReceiptType.ReturnData) {\n      throw new Error(`Expected returnReceipt to be a ReturnDataReceipt`);\n    }\n    const encodedScriptReturn = arrayify(result.returnReceipt.data);\n    const outputs = contractCallScriptAbi[0].outputs;\n    const scriptDataCoder = new AbiCoder().getCoder(outputs[0]) as StructCoder<any>;\n    const [scriptReturn, scriptReturnLength] = scriptDataCoder.decode(encodedScriptReturn, 0);\n    const returnData = encodedScriptReturn.slice(scriptReturnLength);\n\n    const contractCallResults: any[] = [];\n    (scriptReturn.call_returns as any[]).forEach((callResult, i) => {\n      if (callResult) {\n        if (callResult.Data) {\n          const [offset, length] = callResult.Data;\n          contractCallResults[i] = returnData.slice(\n            toNumber(offset),\n            toNumber(offset) + toNumber(length)\n          );\n        } else {\n          contractCallResults[i] = new U64Coder().encode(callResult.Value);\n        }\n      }\n    });\n\n    return contractCallResults;\n  }\n);\n","export default '0x90000004470000000000000000000cd45dfcc00110fff3001a5c5000910005b861440006724002d0164114005b40100d360000006158000c61440001504175305f5d10a6504175305d4570a6504171385f5d1027504171385d417027134100007340001a9000001f1a445000910000085d43f0005f4500009000002b504171385d4170271341004073400024900000291a445000910000085d43f0015f4500009000002b360000001a44000050417528504175286041100850457528504170085041700860411008504170085d4100001341000073400037900000396144000c9000003b360000001a440000504174305f5d1086504174305d4570865d43f00210450440504174485f5d108961440001504175405f5d10a8504175405d4570a8504171405f5d1028504171405d417028134100007340004f900000541a445000910000085d43f0005f45000090000060504171405d41702813410040734000599000005e1a445000910000085d43f0015f45000090000060360000001a44000050417538504175386041100850457538504170005041700060411008504170005d410000134100007340006c9000006e6144000690000078504170005d410000134100407340007390000076360000001a44000090000078360000001a4400005d43f00220451400504173805f5d1070504174485d497089504173805d4170701a445000910000105f4520005f450001504175a8504175a8604110105d47f00326440000504470015041726050417260604110a026000000504070011a445000910000105f4500005f440001504174785041747860411010504173505f5c006a5d47f0025d43f00412451400504173005f5d1060504173505d45706a504173005d41706016411400734000a4900000b150496000504173505d41706a5545009010452440504170785041707860411090504170785d41000013410040734001249000031f504972601a445000910000a050411000604120a05041748850417488604110a026000000504070011a445000910000105f4500005f44000150417198504171986041101050517198505574885d454001504174085f5d10815d4540015d43f00310450440504173c85f5d10795d4140005d4d4001504573c85d457079154914c0734800d3900000e12644000050487001504573a85f5d207515453000734400da900000de504573a85d457075284504c0900000de504173a85d417075900000e15f510000504173c85d4170795f5100015d454000504174085d417081104504405d43f0032845540050557198505174785d41400113410000734000f1900000f35d4150019000011c5d455001504174105f5d10825d4550015d41400110450440504173d05f5d107a5d4150005d4d5001504573d05d45707a154914c073480102900001102644000050487001504573b05f5d207615453000734401099000010d504573b05d457076284504c09000010d504173b05d417076900001105f550000504173d05d41707a5f5500015d4940005d455000504174105d417082104504405d414001284524005d417082504171985d450000504171985d41000125450000504574885d43f003254500005041707850450008504171a8504171a860411088504171a850450028504171085041710860411018504171085d41000013410000734001339000013f504171085d450002504175485f5d10a9504175485d4970a91a445000910000185d43f0005f4500005f4520029000017b504171085d41000013410040734001449000016050417108504100085d450000504173e85f5d107d50417108504100085d450001504173785f5d106f504175a85d450000504173e85d41707d10450440504173785d41706f1a485000910000105f4910005f4900011a445000910000185d43f0015f45000050411008604120109000017b50417108504100085d450000504173f05f5d107e50417108504100085d450001504173905f5d1072504175a85d450000504173f05d41707e10450440504173905d4170721a485000910000105f4910005f4900011a445000910000185d43f0015f4500005041100860412010504173085041730860411018504171a850550000504171a85d51000450457308504171a8504d0040504170105041701060411018504170105d410000134100007340018d90000194504170105d450002504175505f5d10aa504175505d4570aa900001a8504170105d4100001341004073400199900001a150417010504100085d450000504174385f5d1087504174385d457087900001a850417010504100085d450000504174505f5d108a504174505d45708a504173205f5d1064504173205d4970641a4450009100003050411000604150205f4540045f45200550417230504172306041103050453000504170285041702860411010504170285d41000013410040734001be900001c5504170285d450001504171485f5d1029504171485d457029900001cd504170285d41000013410000734001ca900001cc1a440000900001cd1a440000504171505f5d102a50453010504170385041703860411028504170385d41000013410040734001d8900001df504170385045000850417358504173586041102050497358900001f1504170385d41000013410000734001e4900001eb1a485000910000205d47f00a104513005041200060411020900001f11a485000910000205d47f00a10451300504120006041102050417158504171586041202050453038504170605041706060411010504170605d41000013410040734001fd90000204504170605d450001504173405f5d1068504173405d4570689000020c504170605d41000013410000734002099000020b1a44a0009000020c1a44a000504173485f5d1069504d7230504171505d49702a50457158504173485d4170692d4d24501a44e000504170705f5d100e504170705d41700e134100007340021d900002281a44d000504175785f5d10af504175785d4570af1a485000910000185d43f0005f4900005f4910029000023d504170705d45700e504173885f5d10711a44d000504174585f5d108b504174585d49708b504173885d4170711a445000910000105f4520005f4500011a485000910000185d43f0015f490000504120086041101050417460504174606041201850457460504171205041712060411018504171205d410000134100007340024990000255504171205d450002504175a05f5d10b4504175a05d4970b41a445000910000185d43f0005f4500005f45200290000309504171205d410000134100407340025a900002b250417120504100085d450000504174285f5d108550417120504100085d450001504173985f5d1073504174285d497085504173985d4170731a445000910000105f4520005f45000150417178504171786041101050557478505171785d4140011341000073400275900002775d455001900002a15d455001504174185f5d10835d4550015d41400110450440504173d85f5d107b5d4150005d4d5001504573d85d45707b154914c073480286900002942644000050487001504573b85f5d2077154530007344028d90000291504573b85d457077284504c090000291504173b85d417077900002945f550000504173d85d41707b5f5500015d4940005d455000504174185d417083104504405d41400128452400504174185d457083504173f85f5d107f504173f85d45707f504173985d4170731a485000910000105f4910005f4900011a445000910000185d43f0015f45000050411008604120109000030950417120504100085d450000504174405f5d108850417120504100085d450001504173a05f5d1074504174405d497088504173a05d4170741a445000910000105f4520005f45000150417188504171886041101050557478505171885d41400113410000734002cd900002cf5d455001900002f95d455001504174205f5d10845d4550015d41400110450440504173e05f5d107c5d4150005d4d5001504573e05d45707c154914c0734802de900002ec2644000050487001504573c05f5d207815453000734402e5900002e9504573c05d457078284504c0900002e9504173c05d417078900002ec5f550000504173e05d41707c5f5500015d4940005d455000504174205d417084104504405d41400128452400504174205d457084504174005f5d1080504174005d457080504173a05d4170741a485000910000105f4910005f4900011a445000910000185d43f0015f4500005041100860412010504173285041732860411018504973281a445000910000205d43f0015f450000504110086041201850417558504175586041102050457260504173505d41706a5549002010491480504575585d43f009284914009000032e504175801a445000910000205d43f0005f450000504175806041102050457260504173505d41706a5549002010491480504575805d43f0092849140050417350504173505d41706a104014005f5d006a9000009d470000000000000000000000000000000000000100000000000002d000000000000000a00000000000000090000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000cfc';\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport type { BytesLike } from '@ethersproject/bytes';\nimport { arrayify } from '@ethersproject/bytes';\nimport { Logger } from '@ethersproject/logger';\nimport {\n  VM_TX_MEMORY,\n  TRANSACTION_SCRIPT_FIXED_SIZE,\n  ASSET_ID_LEN,\n  WORD_SIZE,\n  CONTRACT_ID_LEN,\n} from '@fuel-ts/abi-coder';\nimport type { BN } from '@fuel-ts/math';\nimport type {\n  CallResult,\n  TransactionResultReceipt,\n  TransactionResultReturnReceipt,\n  TransactionResultReturnDataReceipt,\n  TransactionResultRevertReceipt,\n  TransactionResultScriptResultReceipt,\n  TransactionResult,\n} from '@fuel-ts/providers';\nimport { ReceiptType, ByteArrayCoder } from '@fuel-ts/transactions';\nimport { versions } from '@fuel-ts/versions';\n\nimport { ScriptResultDecoderError } from './errors';\nimport type { CallConfig } from './types';\n\nconst logger = new Logger(versions.FUELS);\n\nexport type ScriptResult = {\n  code: BN;\n  gasUsed: BN;\n  receipts: TransactionResultReceipt[];\n  scriptResultReceipt: TransactionResultScriptResultReceipt;\n  returnReceipt:\n    | TransactionResultReturnReceipt\n    | TransactionResultReturnDataReceipt\n    | TransactionResultRevertReceipt;\n  callResult: CallResult;\n};\n\nfunction callResultToScriptResult(callResult: CallResult): ScriptResult {\n  const receipts = [...callResult.receipts];\n\n  // Every script call ends with two specific receipts\n  // Here we check them so `this.scriptResultDecoder` doesn't have to\n  const scriptResultReceipt = receipts.pop();\n  if (!scriptResultReceipt) {\n    throw new Error(`Expected scriptResultReceipt`);\n  }\n  if (scriptResultReceipt.type !== ReceiptType.ScriptResult) {\n    throw new Error(`Invalid scriptResultReceipt type: ${scriptResultReceipt.type}`);\n  }\n  const returnReceipt = receipts.pop();\n  if (!returnReceipt) {\n    throw new Error(`Expected returnReceipt`);\n  }\n  if (\n    returnReceipt.type !== ReceiptType.Return &&\n    returnReceipt.type !== ReceiptType.ReturnData &&\n    returnReceipt.type !== ReceiptType.Revert\n  ) {\n    throw new Error(`Invalid returnReceipt type: ${returnReceipt.type}`);\n  }\n\n  const scriptResult = {\n    code: scriptResultReceipt.result,\n    gasUsed: scriptResultReceipt.gasUsed,\n    receipts,\n    scriptResultReceipt,\n    returnReceipt,\n    callResult,\n  };\n\n  return scriptResult;\n}\n\nfunction decodeCallResult<TResult>(\n  callResult: CallResult,\n  decoder: (scriptResult: ScriptResult) => TResult,\n  logs: Array<any> = []\n): TResult {\n  try {\n    const scriptResult = callResultToScriptResult(callResult);\n    return decoder(scriptResult);\n  } catch (error) {\n    throw new ScriptResultDecoderError(\n      callResult as TransactionResult<'failure'>,\n      (error as Error).message,\n      logs\n    );\n  }\n}\n\nexport function callResultToInvocationResult<TReturn>(\n  callResult: CallResult,\n  call: CallConfig,\n  logs?: unknown[]\n): TReturn {\n  return decodeCallResult(\n    callResult,\n    (scriptResult: ScriptResult) => {\n      if (scriptResult.returnReceipt.type === ReceiptType.Revert) {\n        logger.throwError('Script Reverted', Logger.errors.CALL_EXCEPTION, logs);\n      }\n\n      if (\n        scriptResult.returnReceipt.type !== ReceiptType.Return &&\n        scriptResult.returnReceipt.type !== ReceiptType.ReturnData\n      ) {\n        logger.throwError(\n          `Script Return Type [${scriptResult.returnReceipt.type}] Invalid`,\n          Logger.errors.CALL_EXCEPTION,\n          {\n            logs,\n            receipt: scriptResult.returnReceipt,\n          }\n        );\n      }\n\n      let value;\n      if (scriptResult.returnReceipt.type === ReceiptType.Return) {\n        value = scriptResult.returnReceipt.val;\n      }\n      if (scriptResult.returnReceipt.type === ReceiptType.ReturnData) {\n        const decoded = call.program.interface.decodeFunctionResult(\n          call.func,\n          scriptResult.returnReceipt.data\n        );\n        value = (decoded as [TReturn])[0];\n      }\n\n      return value as TReturn;\n    },\n    logs\n  );\n}\n\nexport class ScriptRequest<TData = void, TResult = void> {\n  bytes: Uint8Array;\n  scriptDataEncoder: (data: TData) => Uint8Array;\n  scriptResultDecoder: (scriptResult: ScriptResult) => TResult;\n\n  constructor(\n    bytes: BytesLike,\n    scriptDataEncoder: (data: TData) => Uint8Array,\n    scriptResultDecoder: (scriptResult: ScriptResult) => TResult\n  ) {\n    this.bytes = arrayify(bytes);\n    this.scriptDataEncoder = scriptDataEncoder;\n    this.scriptResultDecoder = scriptResultDecoder;\n  }\n\n  getScriptDataOffset() {\n    return (\n      VM_TX_MEMORY +\n      TRANSACTION_SCRIPT_FIXED_SIZE +\n      new ByteArrayCoder(this.bytes.length).encodedLength\n    );\n  }\n\n  /**\n   * Returns the memory offset for the contract call argument\n   * Used for struct inputs\n   */\n  getArgOffset() {\n    const callDataOffset = this.getScriptDataOffset() + ASSET_ID_LEN + WORD_SIZE;\n    return callDataOffset + CONTRACT_ID_LEN + WORD_SIZE + WORD_SIZE;\n  }\n\n  /**\n   * Encodes the data for a script call\n   */\n  encodeScriptData(data: TData): Uint8Array {\n    return this.scriptDataEncoder(data);\n  }\n\n  /**\n   * Decodes the result of a script call\n   */\n  decodeCallResult(callResult: CallResult, logs: Array<any> = []): TResult {\n    return decodeCallResult(callResult, this.scriptResultDecoder, logs);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-classes-per-file */\nimport type { Interface } from '@fuel-ts/abi-coder';\nimport type { AbstractProgram } from '@fuel-ts/interfaces';\nimport type { BN } from '@fuel-ts/math';\nimport { bn } from '@fuel-ts/math';\nimport type {\n  TransactionResult,\n  CallResult,\n  TransactionResponse,\n  TransactionResultReceipt,\n} from '@fuel-ts/providers';\nimport { getDecodedLogs } from '@fuel-ts/providers';\nimport type { ReceiptScriptResult } from '@fuel-ts/transactions';\nimport { ReceiptType } from '@fuel-ts/transactions';\n\nimport { contractCallScript } from '../contract-call-script';\nimport { callResultToInvocationResult } from '../script-request';\nimport type { CallConfig, InvocationScopeLike } from '../types';\n\nfunction getGasUsage(callResult: CallResult) {\n  const scriptResult = callResult.receipts.find((r) => r.type === ReceiptType.ScriptResult) as\n    | ReceiptScriptResult\n    | undefined;\n  return scriptResult?.gasUsed || bn(0);\n}\n\nexport class InvocationResult<T = any> {\n  readonly functionScopes: Array<InvocationScopeLike>;\n  readonly isMultiCall: boolean;\n  readonly gasUsed: BN;\n  readonly value: T;\n\n  constructor(\n    funcScopes: InvocationScopeLike | Array<InvocationScopeLike>,\n    callResult: CallResult,\n    isMultiCall: boolean\n  ) {\n    this.functionScopes = Array.isArray(funcScopes) ? funcScopes : [funcScopes];\n    this.isMultiCall = isMultiCall;\n    this.value = this.getDecodedValue(callResult);\n    this.gasUsed = getGasUsage(callResult);\n  }\n\n  private getFirstCallConfig(): CallConfig | undefined {\n    if (!this.functionScopes[0]) {\n      return undefined;\n    }\n\n    return this.functionScopes[0].getCallConfig();\n  }\n\n  protected getDecodedValue(callResult: CallResult) {\n    const logs = this.getDecodedLogs(callResult.receipts);\n    const callConfig = this.getFirstCallConfig();\n    if (this.functionScopes.length === 1 && callConfig && 'bytes' in callConfig.program) {\n      return callResultToInvocationResult<T>(callResult, callConfig, logs);\n    }\n\n    const encodedResults = contractCallScript.decodeCallResult(callResult, logs);\n    const returnValues = encodedResults.map((encodedResult, i) => {\n      const { program, func } = this.functionScopes[i].getCallConfig();\n      return program.interface.decodeFunctionResult(func, encodedResult)?.[0];\n    });\n    return (this.isMultiCall ? returnValues : returnValues?.[0]) as T;\n  }\n\n  protected getDecodedLogs(receipts: Array<TransactionResultReceipt>) {\n    const callConfig = this.getFirstCallConfig();\n    if (!callConfig) {\n      return [];\n    }\n\n    const { program } = callConfig;\n    return getDecodedLogs(receipts, program.interface as Interface);\n  }\n}\n\nexport class FunctionInvocationResult<\n  T = any,\n  TTransactionType = void\n> extends InvocationResult<T> {\n  readonly transactionId: string;\n  readonly transactionResponse: TransactionResponse;\n  readonly transactionResult: TransactionResult<any, TTransactionType>;\n  readonly program: AbstractProgram;\n  readonly logs!: Array<any>;\n\n  constructor(\n    funcScopes: InvocationScopeLike | Array<InvocationScopeLike>,\n    transactionResponse: TransactionResponse,\n    transactionResult: TransactionResult<any, TTransactionType>,\n    program: AbstractProgram,\n    isMultiCall: boolean\n  ) {\n    super(funcScopes, transactionResult, isMultiCall);\n    this.transactionResponse = transactionResponse;\n    this.transactionResult = transactionResult;\n    this.transactionId = this.transactionResponse.id;\n    this.program = program;\n    this.logs = this.getDecodedLogs(transactionResult.receipts);\n  }\n\n  static async build<T, TTransactionType = void>(\n    funcScope: InvocationScopeLike | Array<InvocationScopeLike>,\n    transactionResponse: TransactionResponse,\n    isMultiCall: boolean,\n    program: AbstractProgram\n  ) {\n    const txResult = await transactionResponse.waitForResult<TTransactionType>();\n    const fnResult = new FunctionInvocationResult<T, TTransactionType>(\n      funcScope,\n      transactionResponse,\n      txResult,\n      program,\n      isMultiCall\n    );\n    return fnResult;\n  }\n}\n\nexport class InvocationCallResult<T = any> extends InvocationResult<T> {\n  readonly callResult: CallResult;\n\n  constructor(\n    funcScopes: InvocationScopeLike | Array<InvocationScopeLike>,\n    callResult: CallResult,\n    isMultiCall: boolean\n  ) {\n    super(funcScopes, callResult, isMultiCall);\n    this.callResult = callResult;\n  }\n\n  static async build<T>(\n    funcScopes: InvocationScopeLike | Array<InvocationScopeLike>,\n    callResult: CallResult,\n    isMultiCall: boolean\n  ) {\n    const fnResult = new InvocationCallResult<T>(funcScopes, callResult, isMultiCall);\n    return fnResult;\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport type { AbstractContract } from '@fuel-ts/interfaces';\n\nimport { BaseInvocationScope } from './base-invocation-scope';\nimport type { FunctionInvocationScope } from './invocation-scope';\n\nexport class MultiCallInvocationScope<TReturn = any> extends BaseInvocationScope<TReturn> {\n  constructor(contract: AbstractContract, funcScopes: Array<FunctionInvocationScope>) {\n    super(contract, true);\n    this.addCalls(funcScopes);\n  }\n\n  addCall(funcScope: FunctionInvocationScope) {\n    return super.addCalls([funcScope]);\n  }\n\n  addCalls(funcScopes: Array<FunctionInvocationScope>) {\n    return super.addCalls(funcScopes);\n  }\n}\n","import type { BytesLike } from '@ethersproject/bytes';\nimport type { FunctionFragment, JsonAbi, JsonFlatAbi } from '@fuel-ts/abi-coder';\nimport { Interface } from '@fuel-ts/abi-coder';\nimport { Address } from '@fuel-ts/address';\nimport type { AbstractAddress, AbstractContract } from '@fuel-ts/interfaces';\nimport type { Provider } from '@fuel-ts/providers';\nimport type { Account } from '@fuel-ts/wallet';\n\nimport { FunctionInvocationScope } from './functions/invocation-scope';\nimport { MultiCallInvocationScope } from './functions/multicall-scope';\nimport type { InvokeFunctions } from './types';\n\nexport default class Contract implements AbstractContract {\n  id!: AbstractAddress;\n  provider!: Provider | null;\n  interface!: Interface;\n  account!: Account | null;\n  functions: InvokeFunctions = {};\n\n  constructor(\n    id: string | AbstractAddress,\n    abi: JsonAbi | JsonFlatAbi | Interface,\n    accountOrProvider: Account | Provider\n  ) {\n    this.interface = abi instanceof Interface ? abi : new Interface(abi);\n    this.id = Address.fromAddressOrString(id);\n\n    /**\n      Instead of using `instanceof` to compare classes, we instead check\n      if `accountOrProvider` have a `provider` property inside. If yes,\n      than we assume it's a Wallet.\n\n      This approach is safer than using `instanceof` because it\n      there might be different versions and bundles of the library.\n\n      The same is done at:\n        - ./contract-factory.ts\n\n      @see ContractFactory\n    */\n    if (accountOrProvider && 'provider' in accountOrProvider) {\n      this.provider = accountOrProvider.provider;\n      this.account = accountOrProvider;\n    } else {\n      this.provider = accountOrProvider;\n      this.account = null;\n    }\n\n    Object.keys(this.interface.functions).forEach((name) => {\n      const fragment = this.interface.getFunction(name);\n      Object.defineProperty(this.functions, fragment.name, {\n        value: this.buildFunction(fragment),\n        writable: false,\n      });\n    });\n  }\n\n  buildFunction(func: FunctionFragment) {\n    return (...args: Array<unknown>) => new FunctionInvocationScope(this, func, args);\n  }\n\n  multiCall(calls: Array<FunctionInvocationScope>) {\n    return new MultiCallInvocationScope(this, calls);\n  }\n\n  /**\n   * Get the balance for a given assset ID for this contract\n   */\n  getBalance(assetId: BytesLike) {\n    if (!this.provider) {\n      throw new Error('Contract instance has no provider.');\n    }\n\n    return this.provider.getContractBalance(this.id, assetId);\n  }\n}\n"],"mappings":"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","names":["src_exports","__export","Contract","FunctionInvocationResult","FunctionInvocationScope","InvocationResult","MultiCallInvocationScope","ScriptRequest","ScriptResultDecoderError","assert","getDocs","__toCommonJS","PANIC_REASONS","PANIC_DOC_URL","getFailureReason","reason","PANIC_REASONS","getDocs","status","PANIC_DOC_URL","assert","condition","message","import_constants","import_transactions","bigintReplacer","key","value","printLineWithId","id","line","ScriptResultDecoderError","result","message","logs","docLink","getDocs","revertReceipts","r","revertsText","logsText","receiptsText","type","import_providers","import_math","import_providers","import_transactions","import_bytes","import_abi_coder","import_math","import_transactions","multicall_bin_default","import_bytes","import_logger","import_abi_coder","import_transactions","import_versions","logger","callResultToScriptResult","callResult","receipts","scriptResultReceipt","returnReceipt","decodeCallResult","decoder","logs","scriptResult","error","ScriptResultDecoderError","callResultToInvocationResult","call","value","ScriptRequest","bytes","scriptDataEncoder","scriptResultDecoder","data","contractCallScript","ScriptRequest","multicall_bin_default","contractCalls","inputs","multicall_abi_default","scriptDataCoder","callSlotsLength","refArgData","scriptCallSlots","i","call","scriptCallSlot","dataArray","functionSelector","isReferenceType","b","args","fnArg","scriptData","encodedScriptData","result","encodedScriptReturn","outputs","scriptReturn","scriptReturnLength","returnData","contractCallResults","callResult","offset","length","import_math","import_providers","import_transactions","getGasUsage","callResult","scriptResult","r","InvocationResult","funcScopes","isMultiCall","logs","callConfig","callResultToInvocationResult","returnValues","contractCallScript","encodedResult","i","_a","program","func","receipts","FunctionInvocationResult","transactionResponse","transactionResult","funcScope","txResult","InvocationCallResult","createContractCall","funcScope","program","args","forward","func","callParameters","bytesOffset","data","contractCallScript","BaseInvocationScope","isMultiCall","options","calls","c","call","assetId","amount","assets","reduceForwardCoins","requiredCoins","_a","currentAmount","funcScopes","total","provider","assert","request","i","resources","txParams","contracts","contract","transactionRequest","response","FunctionInvocationResult","result","InvocationCallResult","FunctionInvocationScope","BaseInvocationScope","program","func","args","callParams","MultiCallInvocationScope","BaseInvocationScope","contract","funcScopes","funcScope","import_abi_coder","import_address","Contract","id","abi","accountOrProvider","name","fragment","func","args","FunctionInvocationScope","calls","MultiCallInvocationScope","assetId"]}