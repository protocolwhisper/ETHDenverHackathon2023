var S=(i=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(i,{get:(r,e)=>(typeof require!="undefined"?require:r)[e]}):i)(function(i){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var D=(i,r)=>()=>(i&&(r=i(i=0)),r);var s=D(()=>{});s();s();s();s();var l="http://127.0.0.1:4000/graphql";s();import{HDWallet as k}from"@fuel-ts/hdwallet";import{Mnemonic as $}from"@fuel-ts/mnemonic";import{Signer as E}from"@fuel-ts/signer";s();import{arrayify as L,hexlify as Q}from"@ethersproject/bytes";import{Address as O}from"@fuel-ts/address";import{NativeAssetId as C}from"@fuel-ts/constants";import{AbstractAccount as _}from"@fuel-ts/interfaces";import{bn as G}from"@fuel-ts/math";import{withdrawScript as V,ScriptTransactionRequest as N,Provider as I,transactionRequestify as K}from"@fuel-ts/providers";import{MAX_GAS_PER_TX as q}from"@fuel-ts/transactions";var g=class extends _{constructor(e,t=l){super();this.provider=this.connect(t),this.address=O.fromDynamicInput(e)}connect(e){return typeof e=="string"?this.provider?this.provider.connect(e):this.provider=new I(e):this.provider=e,this.provider}async getResourcesToSpend(e,t){return this.provider.getResourcesToSpend(this.address,e,t)}async getCoins(e){let t=[],a;for(;;){let d=await this.provider.getCoins(this.address,e,{first:9999,after:a});if(t.push(...d),!(d.length>=9999))break;throw new Error(`Wallets with more than ${9999} coins are not yet supported`)}return t}async getMessages(){let e=[],o;for(;;){let a=await this.provider.getMessages(this.address,{first:9999,after:o});if(e.push(...a),!(a.length>=9999))break;throw new Error(`Wallets with more than ${9999} messages are not yet supported`)}return e}async getBalance(e=C){return await this.provider.getBalance(this.address,e)}async getBalances(){let e=[],o;for(;;){let a=await this.provider.getBalances(this.address,{first:9999,after:o});if(e.push(...a),!(a.length>=9999))break;throw new Error(`Wallets with more than ${9999} balances are not yet supported`)}return e}async fund(e){let t=e.calculateFee(),o=await this.getResourcesToSpend([t]);e.addResources(o)}async transfer(e,t,o=C,a={}){let d={gasLimit:q,...a},m=new N(d);m.addCoinOutput(e,t,o);let y=m.calculateFee(),u=[];y.assetId===Q(o)?(y.amount=y.amount.add(t),u=[y]):u=[[t,o],y];let h=await this.getResourcesToSpend(u);return m.addResources(h),this.sendTransaction(m)}async withdrawToBaseLayer(e,t,o={}){let a=L("0x".concat(e.toHexString().substring(2).padStart(64,"0"))),d=L("0x".concat(G(t).toHex().substring(2).padStart(16,"0"))),y={script:new Uint8Array([...L(V.bytes),...a,...d]),gasLimit:q,...o},u=new N(y);u.addMessageOutputs();let h=u.calculateFee(),A=[];h.amount=h.amount.add(t),A=[h];let z=await this.getResourcesToSpend(A);return u.addResources(z),this.sendTransaction(u)}async sendTransaction(e){let t=K(e);return await this.provider.addMissingVariables(t),this.provider.sendTransaction(t)}async simulateTransaction(e){let t=K(e);return await this.provider.addMissingVariables(t),this.provider.simulate(t)}};s();import{hashMessage as H,hashTransaction as j}from"@fuel-ts/hasher";import{transactionRequestify as P}from"@fuel-ts/providers";import{Signer as J}from"@fuel-ts/signer";var T=class extends g{constructor(e,t=l){let o=new J(e);super(o.address,t);this.signer=()=>o,this.provider=this.connect(t)}get privateKey(){return this.signer().privateKey}get publicKey(){return this.signer().publicKey}async signMessage(e){return this.signer().sign(H(e))}async signTransaction(e){let t=P(e),o=j(t);return this.signer().sign(o)}async populateTransactionWitnessesSignature(e){let t=P(e),o=await this.signTransaction(t);return t.updateWitnessByOwner(this.address,o),t}async sendTransaction(e){let t=P(e);return await this.provider.addMissingVariables(t),this.provider.sendTransaction(await this.populateTransactionWitnessesSignature(t))}async simulateTransaction(e){let t=P(e);return await this.provider.addMissingVariables(t),this.provider.call(await this.populateTransactionWitnessesSignature(t),{utxoValidation:!0})}};T.defaultPath="m/44'/1179993420'/0'/0/0";var v=class extends g{unlock(r){return new n(r,this.provider)}},n=class extends T{lock(){return this.signer=()=>new E("0x00"),new v(this.address,this.provider)}static generate(r){let e=E.generatePrivateKey(r==null?void 0:r.entropy);return new n(e,r==null?void 0:r.provider)}static fromSeed(r,e,t){let a=k.fromSeed(r).derivePath(e||n.defaultPath);return new n(a.privateKey,t)}static fromMnemonic(r,e,t,o){let a=$.mnemonicToSeed(r,t),m=k.fromSeed(a).derivePath(e||n.defaultPath);return new n(m.privateKey,o)}static fromExtendedKey(r,e){let t=k.fromExtendedKey(r);return new n(t.privateKey,e)}};var f=class{static fromAddress(r,e=l){return new v(r,e)}static fromPrivateKey(r,e=l){return new n(r,e)}};f.generate=n.generate,f.fromSeed=n.fromSeed,f.fromMnemonic=n.fromMnemonic,f.fromExtendedKey=n.fromExtendedKey;s();s();s();s();s();import{arrayify as Be}from"@ethersproject/bytes";s();var b,B="Node";typeof globalThis<"u"&&globalThis.crypto&&(b=globalThis.crypto,B="Web");if(!b&&typeof S=="function")try{b=S("crypto"),B="Node"}catch(i){console.error("keystore expects a standard Web browser or Node environment.",i)}var w=b,x=B;s();var R=i=>x==="Node"?w.randomBytes(i):w.getRandomValues(new Uint8Array(i));s();import{coinQuantityfy as X,ScriptTransactionRequest as Y}from"@fuel-ts/providers";var M=async(i,r)=>{let e=new n(process.env.GENESIS_SECRET||R(32),i.provider),t=await e.getResourcesToSpend(r),o=new Y({gasLimit:1e4,gasPrice:1});o.addResources(t),r.map(X).forEach(({amount:d,assetId:m})=>o.addCoinOutput(i.address,d,m)),await(await e.sendTransaction(o)).wait()};var it=async(i,r)=>{let e=f.generate({provider:i});return r&&await M(e,r),e};export{it as generateTestWallet,M as seedTestWallet};
//# sourceMappingURL=test-utils.mjs.map