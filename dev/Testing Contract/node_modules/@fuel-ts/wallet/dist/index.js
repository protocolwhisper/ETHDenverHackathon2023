"use strict";var L=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var W=Object.prototype.hasOwnProperty;var z=(n,s)=>{for(var e in s)L(n,e,{get:s[e],enumerable:!0})},F=(n,s,e,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of N(s))!W.call(n,r)&&r!==e&&L(n,r,{get:()=>s[r],enumerable:!(t=C(s,r))||t.enumerable});return n};var Q=n=>F(L({},"__esModule",{value:!0}),n);var U={};z(U,{Account:()=>g,BaseWalletUnlocked:()=>y,Wallet:()=>h,WalletLocked:()=>l,WalletUnlocked:()=>i});module.exports=Q(U);var P=require("@fuel-ts/hasher"),T=require("@fuel-ts/providers"),E=require("@fuel-ts/signer");var f=require("@ethersproject/bytes"),q=require("@fuel-ts/address"),S=require("@fuel-ts/constants"),A=require("@fuel-ts/interfaces"),B=require("@fuel-ts/math"),o=require("@fuel-ts/providers"),x=require("@fuel-ts/transactions");var m="http://127.0.0.1:4000/graphql";var g=class extends A.AbstractAccount{constructor(e,t=m){super();this.provider=this.connect(t),this.address=q.Address.fromDynamicInput(e)}connect(e){return typeof e=="string"?this.provider?this.provider.connect(e):this.provider=new o.Provider(e):this.provider=e,this.provider}async getResourcesToSpend(e,t){return this.provider.getResourcesToSpend(this.address,e,t)}async getCoins(e){let t=[],a;for(;;){let c=await this.provider.getCoins(this.address,e,{first:9999,after:a});if(t.push(...c),!(c.length>=9999))break;throw new Error(`Wallets with more than ${9999} coins are not yet supported`)}return t}async getMessages(){let e=[],r;for(;;){let a=await this.provider.getMessages(this.address,{first:9999,after:r});if(e.push(...a),!(a.length>=9999))break;throw new Error(`Wallets with more than ${9999} messages are not yet supported`)}return e}async getBalance(e=S.NativeAssetId){return await this.provider.getBalance(this.address,e)}async getBalances(){let e=[],r;for(;;){let a=await this.provider.getBalances(this.address,{first:9999,after:r});if(e.push(...a),!(a.length>=9999))break;throw new Error(`Wallets with more than ${9999} balances are not yet supported`)}return e}async fund(e){let t=e.calculateFee(),r=await this.getResourcesToSpend([t]);e.addResources(r)}async transfer(e,t,r=S.NativeAssetId,a={}){let c={gasLimit:x.MAX_GAS_PER_TX,...a},d=new o.ScriptTransactionRequest(c);d.addCoinOutput(e,t,r);let u=d.calculateFee(),p=[];u.assetId===(0,f.hexlify)(r)?(u.amount=u.amount.add(t),p=[u]):p=[[t,r],u];let R=await this.getResourcesToSpend(p);return d.addResources(R),this.sendTransaction(d)}async withdrawToBaseLayer(e,t,r={}){let a=(0,f.arrayify)("0x".concat(e.toHexString().substring(2).padStart(64,"0"))),c=(0,f.arrayify)("0x".concat((0,B.bn)(t).toHex().substring(2).padStart(16,"0"))),u={script:new Uint8Array([...(0,f.arrayify)(o.withdrawScript.bytes),...a,...c]),gasLimit:x.MAX_GAS_PER_TX,...r},p=new o.ScriptTransactionRequest(u);p.addMessageOutputs();let R=p.calculateFee(),b=[];R.amount=R.amount.add(t),b=[R];let M=await this.getResourcesToSpend(b);return p.addResources(M),this.sendTransaction(p)}async sendTransaction(e){let t=(0,o.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.sendTransaction(t)}async simulateTransaction(e){let t=(0,o.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.simulate(t)}};var y=class extends g{constructor(e,t=m){let r=new E.Signer(e);super(r.address,t);this.signer=()=>r,this.provider=this.connect(t)}get privateKey(){return this.signer().privateKey}get publicKey(){return this.signer().publicKey}async signMessage(e){return this.signer().sign((0,P.hashMessage)(e))}async signTransaction(e){let t=(0,T.transactionRequestify)(e),r=(0,P.hashTransaction)(t);return this.signer().sign(r)}async populateTransactionWitnessesSignature(e){let t=(0,T.transactionRequestify)(e),r=await this.signTransaction(t);return t.updateWitnessByOwner(this.address,r),t}async sendTransaction(e){let t=(0,T.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.sendTransaction(await this.populateTransactionWitnessesSignature(t))}async simulateTransaction(e){let t=(0,T.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.call(await this.populateTransactionWitnessesSignature(t),{utxoValidation:!0})}};y.defaultPath="m/44'/1179993420'/0'/0/0";var w=require("@fuel-ts/hdwallet"),K=require("@fuel-ts/mnemonic"),k=require("@fuel-ts/signer");var l=class extends g{unlock(s){return new i(s,this.provider)}},i=class extends y{lock(){return this.signer=()=>new k.Signer("0x00"),new l(this.address,this.provider)}static generate(s){let e=k.Signer.generatePrivateKey(s==null?void 0:s.entropy);return new i(e,s==null?void 0:s.provider)}static fromSeed(s,e,t){let a=w.HDWallet.fromSeed(s).derivePath(e||i.defaultPath);return new i(a.privateKey,t)}static fromMnemonic(s,e,t,r){let a=K.Mnemonic.mnemonicToSeed(s,t),d=w.HDWallet.fromSeed(a).derivePath(e||i.defaultPath);return new i(d.privateKey,r)}static fromExtendedKey(s,e){let t=w.HDWallet.fromExtendedKey(s);return new i(t.privateKey,e)}};var h=class{static fromAddress(s,e=m){return new l(s,e)}static fromPrivateKey(s,e=m){return new i(s,e)}};h.generate=i.generate,h.fromSeed=i.fromSeed,h.fromMnemonic=i.fromMnemonic,h.fromExtendedKey=i.fromExtendedKey;0&&(module.exports={Account,BaseWalletUnlocked,Wallet,WalletLocked,WalletUnlocked});
//# sourceMappingURL=index.js.map